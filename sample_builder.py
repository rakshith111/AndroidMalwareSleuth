import pandas as pd
from sklearn.model_selection import train_test_split

# Load your dataset, assuming it's in a CSV file
data = pd.read_csv('malware det//only_true_drebin.csv')

# Separate the benign and malware data
benign_data = data[data['class'] == 'B']
malware_data = data[data['class'] == 'S']

# Split the data into desired subsets
benign_1500, benign_remainder = train_test_split(
    benign_data, train_size=1500, random_state=42)
malware_1000, malware_remainder = train_test_split(
    malware_data, train_size=1000, random_state=42)

# Combine the subsets to create the first subset with 1000 malware and 1500 benign
subset_1 = pd.concat([benign_1500, malware_1000], axis=0)

# Further split the remaining data into subsets of 100 malware and 100 benign
benign_100, _ = train_test_split(
    benign_remainder, train_size=100, random_state=42)
malware_100, _ = train_test_split(
    malware_remainder, train_size=100, random_state=42)

# Combine the subsets to create the second subset with 100 malware and 100 benign
subset_2 = pd.concat([benign_100, malware_100], axis=0)

# Shuffle the rows in the subsets
subset_1 = subset_1.sample(frac=1, random_state=42).reset_index(drop=True)
subset_2 = subset_2.sample(frac=1, random_state=42).reset_index(drop=True)

# Save the subsets to CSV files if needed
subset_1.to_csv('train.csv', index=False)
subset_2.to_csv('test.csv', index=False)
