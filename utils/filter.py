import json

# Load the data
with open(r'sortedfile.json', 'r', encoding="utf-8") as f:
    data = json.load(f)


# Extract the intents
intents = data['intents']

# Sort the keys
sorted_keys = sorted(intents.keys(), key=lambda x: (x.split(".")[2] if len(
    x.split(".")) > 2 else '', x.split(".")[3] if len(x.split(".")) > 3 else ''))

# Create a new dictionary with sorted keys
sorted_intents = {k: intents[k] for k in sorted_keys}

# Save the sorted data
with open('sortedfile.json', 'w', encoding="utf-8") as f:
    json.dump({'intents': sorted_intents}, f, indent=4)

with open('sortedfile.json', encoding="utf-8") as f:
    data = json.load(f)

# Calculate the average count value
counts = data['intents'].values()
avg_count = sum(counts) / len(counts)

# Reduce the average count value by 25%
threshold = avg_count * 0.25
print(threshold)
# Filter the keys based on the count value
filtered_keys = [key for key, value in data['intents'].items()
                 if value >= threshold]

# Save the filtered keys to a file
with open('filtered_keys.txt', 'w', encoding="utf-8") as f:
    f.write('\n'.join(filtered_keys))
