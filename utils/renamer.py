import os
import shutil
import pandas as pd
import argparse


def rename_files(path):
    for filename in os.listdir(path):
        base_file, ext = os.path.splitext(filename)
        if ext != '.apk':
            os.rename(os.path.join(path, filename),
                      os.path.join(path, base_file + '.apk'))
    print('Files renamed successfully!')


def split_files_into_folders(src_folder, dest_folder, n):
    for i in range(n):
        folder_name = os.path.join(dest_folder, f"folder_{i}")
        os.makedirs(folder_name, exist_ok=True)

    files = os.listdir(src_folder)
    num_files = len(files)
    for i, file in enumerate(files):
        folder_index = i % n
        src_path = os.path.join(src_folder, file)
        dest_folder_name = os.path.join(dest_folder, f"folder_{folder_index}")
        dest_path = os.path.join(dest_folder_name, file)
        shutil.move(src_path, dest_path)
        print(f"Moved {file} to {dest_folder_name}")

    print(f"Moved {num_files} files to {n} split folders.")


def merge_csv_files(folder_path, output_file):
    merged_data = pd.DataFrame()

    for file in os.listdir(folder_path):
        if file.endswith('.csv'):
            file_path = os.path.join(folder_path, file)
            data = pd.read_csv(file_path)
            merged_data = pd.concat([merged_data, data])

    merged_data.to_csv(output_file, index=False)
    print('Data merged successfully!')


if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='File operations')
    parser.add_argument('--rename', metavar='path', type=str,
                        help='Rename files in the specified folder')
    parser.add_argument('--split', metavar=('src_folder', 'dest_folder', 'n'),
                        nargs=3, help='Split files from the source folder into n destination folders')
    parser.add_argument('--merge', metavar=('folder_path', 'output_file'), nargs=2,
                        help='Merge CSV files in the specified folder and save the output to a file')
    args = parser.parse_args()

    if args.rename:
        rename_files(args.rename)
    elif args.split:
        src_folder, dest_folder, n = args.split
        split_files_into_folders(src_folder, dest_folder, int(n))
    elif args.merge:
        folder_path, output_file = args.merge
        merge_csv_files(folder_path, output_file)
    else:
        parser.print_help()
'''

To rename files:



python script.py --rename /path/to/folder

To split files into folders:



python script.py --split /path/to/src_folder /path/to/dest_folder n

To merge CSV files:



python script.py --merge /path/to/folder /path/to/output_file.csv

'''