# Android Obfuscated malware detection


# Done
- [x]  `malware det\only_true_drebin.csv` - Tested Drebin Dataset for training (without duplicates data)
- [x]  Tested docker with [MobFS](https://github.com/MobSF/Mobile-Security-Framework-MobSF)
- [x]  Split Chimaera dataset into permission and intent datasets




# MAIN SCRIPTS
- [ ] INIT DOCKERS (MOBFS,ML MODELS)
- [ ] SHOW STATUS OF DOCKERS
- [ ] ACCEPT FOLDER OF APK FILES
- [ ] (OPTIONAL) SHOW OPTIONS OF POSSIBLE MODELS TO CHOOSE FROM
- [ ] PASS APK FILES TO MOBFS
- [ ] SIMULATANEOSLY PASS APK FILES THE INTENT AND PERMISSION EXTRACTOR
- [ ] FILTER OUT UNNECESSARY DATA FROM THE EXTRACTED DATA
- [ ] SAVE THE COUNTS OF APIS
- [ ] BUILD A BODY OF EXTRACTED INTENT,PERMISSION AND API
- [ ] SERVER THE DATA TO THE MODEL
- [ ] WAIT FOR THE MODEL TO RETURN THE RESULT
- [ ] AGGREGATE THE RESULTS BY ADDING THE WEIGHTS OF EACH CATEGORY
- [ ] OUTPUT THE RESULT
# TO DO LIST

- [ ] Build Script to extract intent and permission from apk and save it in csv file
- [ ] Modify MobFS to extract Only apis
- [ ] Save the extracted apis in csv file
- [ ] Create a script to convert MobFS apis to CICMalDroid apis 
- [ ] Filter out the apis,permisson,intents that are not in CICMalDroid dataset and the ones that are not in MobFS dataset
- [ ] Create a script to build a body of extracted apis, permission and intent so it can be sent to the model for evaluation

- [ ] Prepare dataset for training
  - [ ] Build a script to extract api's name from the scan report( CICMalDroid dataset)
  - [ ] save all metadata in csv file for future use (CICMalDroid dataset)
  - [x] Modify Chimaera dataset to only contain permission and intent
  - [x] save all metadata in csv file for future use (Chimaera dataset)
  
  # Additional Tasks

  - [ ] Expand sensitive API list for MobSF
  - [ ] Extract sensitive APIs from CICMalDroid dataset analysis (19k APIs)
  - [ ] Create a new dataset using the extracted sensitive APIs
  - [ ] Pass new input data (APK) to MobSF for API extraction
  - [ ] Update MobSF's predefined API list (yaml) with the new sensitive APIs
  - [ ] Ensure that MobSF scans and extracts the new sensitive APIs during analysis

## Training and testing information
#### Tests to be performed:
- [ ] Test 1: Train model on CICMalDroid dataset + Chimaera dataset for permission and Intent ( ALL MERGED)

#### This is done to check if there is any improvement in the accuracy of the model when the dataset is seperated or not

- [ ] Test 2: Train model on CICMalDroid dataset seperate and  Chimaera dataset for permission and Intent + MobFS dataset for API (API +(PERMISSION + INTENT) ) (SEMISEPERATED)

#### This is done to check if there is any improvement in the accuracy of the model when the dataset is seperated or not

- [ ] Test 3: Train model on CICMalDroid dataset seperate and  Chimaera dataset for permission and Intent + MobFS dataset for API (API + PERMISSION + INTENT) (ALL SEPERATED)


## Final classification
- Count the number of apis extracted  per category and assign a weight to each category this will be used to calculate the final classification  and the amount of attention to be given to each category
  
# References
- [MobFS](https://github.com/MobSF/Mobile-Security-Framework-MobSF)
- [CICMalDroid](https://www.unb.ca/cic/datasets/maldroid-2020.html)
- [Chimaera](https://ieee-dataport.org/open-access/malware-analysis-datasets-chimera-multimodal-deep-learning-android-malware-detection)
