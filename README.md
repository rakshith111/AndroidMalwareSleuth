# AndroidMalwareSleuth: Deobfuscation & ML-based Detectionü§ñ

AndroidMalwareSleuth is a user-friendly interface for analyzing Android applications for potential malware. This UI uses TensorFlow's Random forest classifier and analyses API calls, Intents and Permissions from Android apps and provids a detailed report on their safety.

---

## Quick Start üöÄ
#### (Tested on Windows 10, Python 3.9.16)
1. Clone the repository: `git clone https://github.com/rakshith111/AndroidMalwareSleuth`
2. Install the required dependencies: `pip install -r requirements.txt` OR Create a virtual environment and install the dependencies `conda env create -f ml.yml`
3. Build Headers for the dataset Chimeradataset :warning: IMPORTANT :warning: : Follow steps [here](RandomForest/Datasets/ChimeraDataset/README.md) to build the headers for the dataset
4. Make sure you have Docker installed on your machine. Java JDK 8 is suggest for JADx to work properly
5. Run the following command to get started : ` python src\web_launcher.py`
6. Open the UI in your browser if it doesnt automatically open : `http://localhost:7555/`

---
## Refer to [Screenshots](https://github.com/rakshith111/AndroidMalwareSleuth/blob/main/Screenshots.md) For a preview of the webUI made with streamlit.
## Features üåü

- **In-depth Analysis**: Utilizes machine learning techniques to analyze Android applications for potential threats.
- **User-friendly Interface**: Simple and intuitive design for easy navigation and usage.
- **Detailed Reports**: Provides comprehensive reports about the safety of the analyzed Android

---

### Console Sample OutPut

```
| Dataset                               | Confidence Score | Confidence Percentage |
| --------------------------------------| -----------------| ----------------------|
| mobfs                                 | 0.79          | Malware Confidence @ 79.33% |
| chimera_intents                       | 0.03          | Benign Confidence @ 97.00% |
| chimera_permissions                   | 0.09          | Benign Confidence @ 91.33% |
| chimera_merged                        | 0.06          | Benign Confidence @ 94.33% |

Final Class: Benign Confidence @ 75.83% (Score: 0.24)
```

---


## Training and testing information

#### Tests Performed

- [x] Test 1: Train model on CICMalDroid dataset @ [here](https://github.com/rakshith111/AndroidMalwareSleuth/blob/main/datasetanalysis.md#dataset---cicmaldroiddatasetcicmaldroidxmobfsdatasetcsv)
- [x] Test 2: Train model on CICMalDroid dataset seperate and Chimaera dataset for permission and Intent (PERMISSION + INTENT i.e MERGED) @ [here](https://github.com/rakshith111/AndroidMalwareSleuth/blob/main/datasetanalysis.md#dataset-chimeradatasetcleanedchimeradatasetmerged_cleanedcsv)
- [x] Test 3: Train model on Chimaera dataset for permission and Intent ( PERMISSION + INTENT) (ALL SEPERATED) @ [here](https://github.com/rakshith111/AndroidMalwareSleuth/blob/main/datasetanalysis.md#dataset-chimeradatasetcleanedchimeradatasetintent_cleanedcsv)

#### This was done to check if there is any improvement in the accuracy of the model when the dataset is seperated or not
-------
# References and Credits

- [MobFS](https://github.com/MobSF/Mobile-Security-Framework-MobSF) For API Rules
- [libsast](https://github.com/ajinabraham/libsast) For Feature Extraction
- [JADX](https://github.com/skylot/jadx) For Deobfuscation and Decompilation
- [Chimaera](https://ieee-dataport.org/open-access/malware-analysis-datasets-chimera-multimodal-deep-learning-android-malware-detection)
- [CICMalDroid](https://www.unb.ca/cic/datasets/maldroid-2020.html)
- [Drebin](https://www.kaggle.com/datasets/shashwatwork/android-malware-dataset-for-machine-learning) Modified Drebin dataset for suitable training
- [Tensorflow](https://www.tensorflow.org/decision_forests) For Random Forest Classifier

```
    Samaneh Mahdavifar, Andi Fitriah Abdul Kadir, Rasool Fatemi, Dima Alhadidi, Ali A. Ghorbani; Dynamic Android Malware Category Classification using Semi-Supervised Deep Learning, The 18th IEEE International Conference on Dependable, Autonomic, and Secure Computing (DASC), Aug. 17-24, 2020.

    Samaneh Mahdavifar, Dima Alhadidi, and Ali A. Ghorbani (2022). Effective and Efficient Hybrid Android Malware Classification Using Pseudo-Label Stacked Auto-Encoder, Journal of Network and Systems Management 30 (1), 1-34
```

---

<h4><details>
  <summary>Build your own model and test it </summary>
  <ul>
  <li> To build your own model and test it</li> 
   <li>  Choose a model from the [models](Models) folder</li> 
   <li> modify the dockerfile</li> 
  <li> Create the image by running the dockerfile</li> 
  <code>docker build -t your_image_name . </code>
   <li>Run the docker image</li>
   </ul>
  <code>docker run -p 8500:8500 -p 8501:8501 -t your_image_name </code>

</details></h4><br>

----
## Contributing ü§ù

Contributions are welcome! If you find any bugs or have suggestions for new features, please open an issue or submit a pull request.

## License

Although this is under GPL-3.0 license, we kindly request you to refrain from using this code for any commercial purposes. This is a research project and we would like to keep it that way. Thank you for understanding.
