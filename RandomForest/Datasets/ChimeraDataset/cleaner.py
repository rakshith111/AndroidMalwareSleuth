import pandas as pd
import os
import sys
sys.path.append(
    os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))))

from src.libs._base_logger import logger,ROOT_DIR
from src.libs.color import bcolors
def removeDuplicates():
    BASE_PATH = r'RandomForest\Datasets\ChimeraDataset'
    BASE_PATH = os.path.normpath(BASE_PATH)
    csv_to_clean = ['ChimeraDatasetMerged.csv',
                'ChimeraDatasetIntent.csv', 'ChimeraDatasetPermission.csv']

    if not os.path.exists(f'{BASE_PATH}\Cleaned'):
        os.mkdir(f'{BASE_PATH}\Cleaned')
    # Load the CSV dataset into a pandas dataframe
    for csv in csv_to_clean:

        df = pd.read_csv(f'{BASE_PATH}\\{csv}')
        # Remove duplicate rows
        df = df.drop_duplicates()

        # Remove rows with missing values (including 0 values)
        df = df.dropna()
        df = df.loc[~(df == 0).all(axis=1)]

        # Save the cleaned dataframe to a new CSV file
        df.to_csv(f'{BASE_PATH}\Cleaned\{csv[:-4]}_cleaned.csv', index=False)
        logger.info(f'{bcolors.OKCYAN}[+] Cleaned {csv[:-4]}_cleaned.csv{bcolors.ENDC}')
