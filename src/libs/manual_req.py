import docker
import time
import requests
import json
import pandas as pd
from color import bcolors
from _base_logger import logger, error_logger

# SAMPLE AndroRat
# MOBFS
mobfs_input = {
    "api_kill_process": 1,
    "api_installed": 1,
    "api_get_sim_serial": 1,
    "api_get_subscriber": 1,
    "api_get_running_processes": 0,
    "api_gps": 1,
    "api_send_sms": 1,
    "api_http_connection": 1,
    "api_get_wifi": 0,
    "api_url": 1,
    "api_local_file_io": 1,
    "api_get_location": 1,
    "api_get_phone": 1,
    "api_get_device": 0,
    "api_sms_call": 0,
    "api_get_sim_provider": 1,
    "api_start_activity": 1,
    "api_get_network": 1,
    "class": None
}
# chimera Intents
chimera_intents_input = {
    "androiddotintentdotactiondotmain": 1,
    "androiddotintentdotactiondotboot_completed": 1,
    "androiddotintentdotactiondotview": 0,
    "androiddotintentdotactiondotuser_present": 0,
    "androiddotintentdotactiondotpackage_added": 0,
    "androiddotintentdotactiondotpackage_removed": 0,
    "androiddotintentdotactiondotphone_state": 0,
    "androiddotintentdotactiondotsearch": 0,
    "androiddotintentdotactiondotpackage_replaced": 0,
    "androiddotintentdotactiondotcreate_shortcut": 0,
    "androiddotintentdotactiondotnew_outgoing_call": 0,
    "androiddotintentdotactiondotaction_power_connected": 0,
    "androiddotintentdotactiondotaction_power_disconnected": 0,
    "androiddotintentdotactiondotquickboot_poweron": 0,
    "androiddotintentdotactiondotsend": 0,
    "androiddotintentdotactiondotdata_sms_received": 0,
    "androiddotintentdotactiondotmedia_mounted": 0,
    "androiddotintentdotactiondotdownload_complete": 0,
    "androiddotintentdotactiondotscreen_on": 0,
    "androiddotintentdotactiondotmedia_button": 0,
    "androiddotintentdotactiondotaction_shutdown": 0,
    "androiddotintentdotactiondotmedia_eject": 0,
    "androiddotintentdotactiondotmedia_unmounted": 0,
    "androiddotintentdotactiondotsim_state_changed": 0,
    "androiddotintentdotactiondotany_data_state": 0,
    "androiddotintentdotactiondotbattery_changed": 0,
    "androiddotintentdotactiondotdownload_notification_clicked": 0,
    "androiddotintentdotactiondotpackage_install": 0,
    "androiddotintentdotactiondotmedia_removed": 0,
    "androiddotintentdotactiondotdelete": 0,
    "androiddotintentdotactiondottime_set": 0,
    "androiddotintentdotactiondotservice_state": 0,
    "androiddotintentdotactiondotmedia_checking": 0,
    "androiddotintentdotactiondotsendto": 0,
    "androiddotintentdotactiondottimezone_changed": 0,
    "androiddotintentdotactiondotscreen_off": 0,
    "androiddotintentdotactiondotdate_changed": 0,
    "androiddotintentdotactiondotpick": 0,
    "androiddotintentdotactiondotpackage_restarted": 0,
    "androiddotintentdotactiondotsend_multiple": 0,
    "androiddotintentdotactiondotmy_package_replaced": 0,
    "androiddotintentdotactiondotget_content": 0,
    "androiddotintentdotactiondotnotification_add": 0,
    "androiddotintentdotactiondotnotification_remove": 0,
    "androiddotintentdotactiondotnotification_update": 0,
    "androiddotintentdotactiondotbattery_low": 0,
    "androiddotintentdotactiondotrespond_via_message": 0,
    "androiddotintentdotactiondotset_wallpaper": 0,
    "androiddotintentdotactiondotedit": 0,
    "androiddotintentdotactiondotbattery_okay": 0,
    "androiddotintentdotactiondotairplane_mode": 0,
    "androiddotintentdotactiondotlocale_changed": 0,
    "androiddotintentdotactiondotpackage_changed": 0,
    "androiddotintentdotactiondotheadset_plug": 0,
    "androiddotintentdotactiondotsig_str": 0,
    "androiddotintentdotactiondotaction_external_applications_available": 0,
    "androiddotintentdotactiondotaction_date_changed": 0,
    "androiddotintentdotactiondotaction_time_changed": 0,
    "androiddotintentdotactiondotaction_media_eject": 0,
    "androiddotintentdotactiondotaction_package_added": 0,
    "androiddotintentdotactiondotaction_timezone_changed": 0,
    "androiddotintentdotactiondottime_tick": 0,
    "androiddotintentdotactiondotaction_view_downloads": 0,
    "androiddotintentdotactiondotclose_system_dialogs": 0,
    "androiddotintentdotactiondotweb_search": 0,
    "androiddotintentdotactiondotchinamobile_oms_game": 0,
    "androiddotintentdotactiondotreboot": 0,
    "androiddotintentdotactiondotdial": 0,
    "androiddotintentdotactiondotmedia_scanner_finished": 0,
    "androiddotintentdotactiondotaction_package_changed": 0,
    "androiddotintentdotactiondotpackage_data_cleared": 0,
    "androiddotintentdotactiondotmedia_search": 0,
    "androiddotintentdotactiondotassist": 0,
    "androiddotintentdotactiondotcall": 0,
    "androiddotintentdotactiondotcall_button": 0,
    "androiddotintentdotactiondotwallpaper_changed": 0,
    "androiddotintentdotactiondotquickboot_poweroff": 0,
    "androiddotintentdotactiondotclose_system_alarm": 0,
    "androiddotintentdotactiondotinsert": 0,
    "androiddotintentdotactiondotmedia_bad_removal": 0,
    "androiddotintentdotactiondotsearch_long_press": 0,
    "androiddotintentdotactiondotdefault": 0,
    "androiddotintentdotactiondotmusic_player": 0,
    "androiddotintentdotactiondotums_connected": 0,
    "androiddotintentdotactiondotexternal_applications_available": 0,
    "androiddotintentdotactiondotmedia_shared": 0,
    "androiddotintentdotactiondotcall_privileged": 0,
    "androiddotintentdotactiondotrun": 0,
    "androiddotintentdotactiondotcamsnap": 0,
    "androiddotintentdotactiondotdevice_storage_low": 0,
    "androiddotintentdotactiondotmanage_network_usage": 0,
    "androiddotintentdotactiondotvideocap": 0,
    "androiddotintentdotactiondotcamera_button": 0,
    "androiddotintentdotactiondotpackage_fully_removed": 0,
    "androiddotintentdotactiondotproxy_change": 0,
    "androiddotintentdotactiondotplug_in_airing": 0,
    "androiddotintentdotactiondotset_alarm": 0,
    "androiddotintentdotactiondotmedia_scanner_started": 0,
    "class": None
}
# CHIMERA PERMISSIONS
chimera_permissions_input = {
    "androiddotpermissiondotinternet": 1,
    "androiddotpermissiondotaccess_network_state": 1,
    "androiddotpermissiondotwrite_external_storage": 1,
    "androiddotpermissiondotread_phone_state": 1,
    "androiddotpermissiondotaccess_wifi_state": 0,
    "androiddotpermissiondotwake_lock": 1,
    "androiddotpermissiondotaccess_coarse_location": 1,
    "androiddotpermissiondotvibrate": 1,
    "androiddotpermissiondotaccess_fine_location": 1,
    "androiddotpermissiondotreceive_boot_completed": 1,
    "androiddotpermissiondotget_tasks": 0,
    "androiddotpermissiondotget_accounts": 0,
    "androiddotpermissiondotsystem_alert_window": 1,
    "androiddotpermissiondotread_external_storage": 0,
    "androiddotpermissiondotchange_wifi_state": 0,
    "androiddotpermissiondotsend_sms": 1,
    "androiddotpermissiondotcamera": 1,
    "androiddotpermissiondotwrite_settings": 1,
    "androiddotpermissiondotmount_unmount_filesystems": 0,
    "androiddotpermissiondotreceive_sms": 0,
    "androiddotpermissiondotcall_phone": 1,
    "androiddotpermissiondotread_sms": 1,
    "androiddotpermissiondotread_contacts": 1,
    "androiddotpermissiondotrecord_audio": 1,
    "androiddotpermissiondotread_logs": 0,
    "androiddotpermissiondotchange_network_state": 0,
    "androiddotpermissiondotrestart_packages": 0,
    "androiddotpermissiondotdisable_keyguard": 0,
    "androiddotpermissiondotmodify_audio_settings": 0,
    "androiddotpermissiondotwrite_sms": 0,
    "androiddotpermissiondotaccess_location_extra_commands": 0,
    "androiddotpermissiondotbluetooth": 0,
    "androiddotpermissiondotuse_credentials": 0,
    "androiddotpermissiondotset_wallpaper": 0,
    "androiddotpermissiondotflashlight": 1,
    "androiddotpermissiondotbroadcast_sticky": 0,
    "androiddotpermissiondotwrite_contacts": 0,
    "androiddotpermissiondotprocess_outgoing_calls": 1,
    "androiddotpermissiondotkill_background_processes": 0,
    "androiddotpermissiondotbluetooth_admin": 0,
    "androiddotpermissiondotmanage_accounts": 0,
    "androiddotpermissiondotreceive_user_present": 0,
    "androiddotpermissiondotchange_configuration": 0,
    "androiddotpermissiondotinstall_packages": 0,
    "androiddotpermissiondotaccess_mock_location": 0,
    "androiddotpermissiondotdownload_without_notification": 0,
    "androiddotpermissiondotwrite_apn_settings": 0,
    "androiddotpermissiondotread_call_log": 1,
    "androiddotpermissiondotreceive_mms": 0,
    "androiddotpermissiondotaccess_gps": 0,
    "androiddotpermissiondotread_calendar": 1,
    "androiddotpermissiondotaccess_download_manager": 0,
    "androiddotpermissiondotauthenticate_accounts": 0,
    "androiddotpermissiondotbaidu_location_service": 0,
    "androiddotpermissiondotwrite_calendar": 0,
    "androiddotpermissiondotsystem_overlay_window": 0,
    "androiddotpermissiondotbattery_stats": 0,
    "androiddotpermissiondotdelete_packages": 0,
    "androiddotpermissiondotmodify_phone_state": 0,
    "androiddotpermissiondotget_package_size": 0,
    "androiddotpermissiondotclear_app_cache": 0,
    "androiddotpermissiondotreceive_wap_push": 0,
    "androiddotpermissiondotwrite_call_log": 0,
    "androiddotpermissiondotwrite_secure_settings": 0,
    "androiddotpermissiondotaccess_coarse_updates": 0,
    "androiddotpermissiondotrecord_video": 0,
    "androiddotpermissiondotinteract_across_users_full": 0,
    "androiddotpermissiondotread_settings": 0,
    "androiddotpermissiondotread_profile": 0,
    "androiddotpermissiondotset_wallpaper_hints": 0,
    "androiddotpermissiondotexpand_status_bar": 0,
    "androiddotpermissiondotcall_privileged": 0,
    "androiddotpermissiondotchange_component_enabled_state": 0,
    "androiddotpermissiondotdevice_power": 0,
    "androiddotpermissiondotwrite_sync_settings": 0,
    "androiddotpermissiondotreorder_tasks": 0,
    "androiddotpermissiondotread_sync_settings": 0,
    "androiddotpermissiondotnfc": 0,
    "androiddotpermissiondotchange_wifi_multicast_state": 0,
    "androiddotpermissiondotwrite_owner_data": 0,
    "androiddotpermissiondotset_debug_app": 0,
    "androiddotpermissiondotbroadcast_sms": 0,
    "androiddotpermissiondotpackage_usage_stats": 0,
    "androiddotpermissiondotwrite_internal_storage": 0,
    "androiddotpermissiondotbroadcast_package_added": 0,
    "androiddotpermissiondotbroadcast_package_replaced": 0,
    "androiddotpermissiondotbroadcast_package_install": 0,
    "androiddotpermissiondotaccess_location": 0,
    "androiddotpermissiondotbroadcast_package_changed": 0,
    "androiddotpermissiondotaccess_mtk_mmhw": 0,
    "androiddotpermissiondotread_owner_data": 0,
    "androiddotpermissiondotmanage_documents": 0,
    "androiddotpermissiondotaccess_superuser": 0,
    "androiddotpermissiondotwrite_media_storage": 0,
    "androiddotpermissiondotupdate_device_stats": 0,
    "androiddotpermissiondotaccess_assisted_gps": 0,
    "androiddotpermissiondotread_sync_stats": 0,
    "androiddotpermissiondotraised_thread_priority": 0,
    "androiddotpermissiondotpersistent_activity": 0,
    "class": None
}
# CHIMERA MERGED
chimera_merged_input = {
    "androiddotpermissiondotinternet": 1,
    "androiddotpermissiondotaccess_network_state": 1,
    "androiddotpermissiondotwrite_external_storage": 1,
    "androiddotpermissiondotread_phone_state": 1,
    "androiddotpermissiondotaccess_wifi_state": 0,
    "androiddotpermissiondotwake_lock": 1,
    "androiddotpermissiondotaccess_coarse_location": 1,
    "androiddotpermissiondotvibrate": 1,
    "androiddotpermissiondotaccess_fine_location": 1,
    "androiddotpermissiondotreceive_boot_completed": 1,
    "androiddotpermissiondotget_tasks": 0,
    "androiddotpermissiondotget_accounts": 0,
    "androiddotpermissiondotsystem_alert_window": 1,
    "androiddotpermissiondotread_external_storage": 0,
    "androiddotpermissiondotchange_wifi_state": 0,
    "androiddotpermissiondotsend_sms": 1,
    "androiddotpermissiondotcamera": 1,
    "androiddotpermissiondotwrite_settings": 1,
    "androiddotpermissiondotmount_unmount_filesystems": 0,
    "androiddotpermissiondotreceive_sms": 0,
    "androiddotpermissiondotcall_phone": 1,
    "androiddotpermissiondotread_sms": 1,
    "androiddotpermissiondotread_contacts": 1,
    "androiddotpermissiondotrecord_audio": 1,
    "androiddotpermissiondotread_logs": 0,
    "androiddotpermissiondotchange_network_state": 0,
    "androiddotpermissiondotrestart_packages": 0,
    "androiddotpermissiondotdisable_keyguard": 0,
    "androiddotpermissiondotmodify_audio_settings": 0,
    "androiddotpermissiondotwrite_sms": 0,
    "androiddotpermissiondotaccess_location_extra_commands": 0,
    "androiddotpermissiondotbluetooth": 0,
    "androiddotpermissiondotuse_credentials": 0,
    "androiddotpermissiondotset_wallpaper": 0,
    "androiddotpermissiondotflashlight": 1,
    "androiddotpermissiondotbroadcast_sticky": 0,
    "androiddotpermissiondotwrite_contacts": 0,
    "androiddotpermissiondotprocess_outgoing_calls": 1,
    "androiddotpermissiondotkill_background_processes": 0,
    "androiddotpermissiondotbluetooth_admin": 0,
    "androiddotpermissiondotmanage_accounts": 0,
    "androiddotpermissiondotreceive_user_present": 0,
    "androiddotpermissiondotchange_configuration": 0,
    "androiddotpermissiondotinstall_packages": 0,
    "androiddotpermissiondotaccess_mock_location": 0,
    "androiddotpermissiondotdownload_without_notification": 0,
    "androiddotpermissiondotwrite_apn_settings": 0,
    "androiddotpermissiondotread_call_log": 1,
    "androiddotpermissiondotreceive_mms": 0,
    "androiddotpermissiondotaccess_gps": 0,
    "androiddotpermissiondotread_calendar": 1,
    "androiddotpermissiondotaccess_download_manager": 0,
    "androiddotpermissiondotauthenticate_accounts": 0,
    "androiddotpermissiondotbaidu_location_service": 0,
    "androiddotpermissiondotwrite_calendar": 0,
    "androiddotpermissiondotsystem_overlay_window": 0,
    "androiddotpermissiondotbattery_stats": 0,
    "androiddotpermissiondotdelete_packages": 0,
    "androiddotpermissiondotmodify_phone_state": 0,
    "androiddotpermissiondotget_package_size": 0,
    "androiddotpermissiondotclear_app_cache": 0,
    "androiddotpermissiondotreceive_wap_push": 0,
    "androiddotpermissiondotwrite_call_log": 0,
    "androiddotpermissiondotwrite_secure_settings": 0,
    "androiddotpermissiondotaccess_coarse_updates": 0,
    "androiddotpermissiondotrecord_video": 0,
    "androiddotpermissiondotinteract_across_users_full": 0,
    "androiddotpermissiondotread_settings": 0,
    "androiddotpermissiondotread_profile": 0,
    "androiddotpermissiondotset_wallpaper_hints": 0,
    "androiddotpermissiondotexpand_status_bar": 0,
    "androiddotpermissiondotcall_privileged": 0,
    "androiddotpermissiondotchange_component_enabled_state": 0,
    "androiddotpermissiondotdevice_power": 0,
    "androiddotpermissiondotwrite_sync_settings": 0,
    "androiddotpermissiondotreorder_tasks": 0,
    "androiddotpermissiondotread_sync_settings": 0,
    "androiddotpermissiondotnfc": 0,
    "androiddotpermissiondotchange_wifi_multicast_state": 0,
    "androiddotpermissiondotwrite_owner_data": 0,
    "androiddotpermissiondotset_debug_app": 0,
    "androiddotpermissiondotbroadcast_sms": 0,
    "androiddotpermissiondotpackage_usage_stats": 0,
    "androiddotpermissiondotwrite_internal_storage": 0,
    "androiddotpermissiondotbroadcast_package_added": 0,
    "androiddotpermissiondotbroadcast_package_replaced": 0,
    "androiddotpermissiondotbroadcast_package_install": 0,
    "androiddotpermissiondotaccess_location": 0,
    "androiddotpermissiondotbroadcast_package_changed": 0,
    "androiddotpermissiondotaccess_mtk_mmhw": 0,
    "androiddotpermissiondotread_owner_data": 0,
    "androiddotpermissiondotmanage_documents": 0,
    "androiddotpermissiondotaccess_superuser": 0,
    "androiddotpermissiondotwrite_media_storage": 0,
    "androiddotpermissiondotupdate_device_stats": 0,
    "androiddotpermissiondotaccess_assisted_gps": 0,
    "androiddotpermissiondotread_sync_stats": 0,
    "androiddotpermissiondotraised_thread_priority": 0,
    "androiddotpermissiondotpersistent_activity": 0,
    "androiddotintentdotactiondotmain": 1,
    "androiddotintentdotactiondotboot_completed": 1,
    "androiddotintentdotactiondotview": 0,
    "androiddotintentdotactiondotuser_present": 0,
    "androiddotintentdotactiondotpackage_added": 0,
    "androiddotintentdotactiondotpackage_removed": 0,
    "androiddotintentdotactiondotphone_state": 0,
    "androiddotintentdotactiondotsearch": 0,
    "androiddotintentdotactiondotpackage_replaced": 0,
    "androiddotintentdotactiondotcreate_shortcut": 0,
    "androiddotintentdotactiondotnew_outgoing_call": 0,
    "androiddotintentdotactiondotaction_power_connected": 0,
    "androiddotintentdotactiondotaction_power_disconnected": 0,
    "androiddotintentdotactiondotquickboot_poweron": 0,
    "androiddotintentdotactiondotsend": 0,
    "androiddotintentdotactiondotdata_sms_received": 0,
    "androiddotintentdotactiondotmedia_mounted": 0,
    "androiddotintentdotactiondotdownload_complete": 0,
    "androiddotintentdotactiondotscreen_on": 0,
    "androiddotintentdotactiondotmedia_button": 0,
    "androiddotintentdotactiondotaction_shutdown": 0,
    "androiddotintentdotactiondotmedia_eject": 0,
    "androiddotintentdotactiondotmedia_unmounted": 0,
    "androiddotintentdotactiondotsim_state_changed": 0,
    "androiddotintentdotactiondotany_data_state": 0,
    "androiddotintentdotactiondotbattery_changed": 0,
    "androiddotintentdotactiondotdownload_notification_clicked": 0,
    "androiddotintentdotactiondotpackage_install": 0,
    "androiddotintentdotactiondotmedia_removed": 0,
    "androiddotintentdotactiondotdelete": 0,
    "androiddotintentdotactiondottime_set": 0,
    "androiddotintentdotactiondotservice_state": 0,
    "androiddotintentdotactiondotmedia_checking": 0,
    "androiddotintentdotactiondotsendto": 0,
    "androiddotintentdotactiondottimezone_changed": 0,
    "androiddotintentdotactiondotscreen_off": 0,
    "androiddotintentdotactiondotdate_changed": 0,
    "androiddotintentdotactiondotpick": 0,
    "androiddotintentdotactiondotpackage_restarted": 0,
    "androiddotintentdotactiondotsend_multiple": 0,
    "androiddotintentdotactiondotmy_package_replaced": 0,
    "androiddotintentdotactiondotget_content": 0,
    "androiddotintentdotactiondotnotification_add": 0,
    "androiddotintentdotactiondotnotification_remove": 0,
    "androiddotintentdotactiondotnotification_update": 0,
    "androiddotintentdotactiondotbattery_low": 0,
    "androiddotintentdotactiondotrespond_via_message": 0,
    "androiddotintentdotactiondotset_wallpaper": 0,
    "androiddotintentdotactiondotedit": 0,
    "androiddotintentdotactiondotbattery_okay": 0,
    "androiddotintentdotactiondotairplane_mode": 0,
    "androiddotintentdotactiondotlocale_changed": 0,
    "androiddotintentdotactiondotpackage_changed": 0,
    "androiddotintentdotactiondotheadset_plug": 0,
    "androiddotintentdotactiondotsig_str": 0,
    "androiddotintentdotactiondotaction_external_applications_available": 0,
    "androiddotintentdotactiondotaction_date_changed": 0,
    "androiddotintentdotactiondotaction_time_changed": 0,
    "androiddotintentdotactiondotaction_media_eject": 0,
    "androiddotintentdotactiondotaction_package_added": 0,
    "androiddotintentdotactiondotaction_timezone_changed": 0,
    "androiddotintentdotactiondottime_tick": 0,
    "androiddotintentdotactiondotaction_view_downloads": 0,
    "androiddotintentdotactiondotclose_system_dialogs": 0,
    "androiddotintentdotactiondotweb_search": 0,
    "androiddotintentdotactiondotchinamobile_oms_game": 0,
    "androiddotintentdotactiondotreboot": 0,
    "androiddotintentdotactiondotdial": 0,
    "androiddotintentdotactiondotmedia_scanner_finished": 0,
    "androiddotintentdotactiondotaction_package_changed": 0,
    "androiddotintentdotactiondotpackage_data_cleared": 0,
    "androiddotintentdotactiondotmedia_search": 0,
    "androiddotintentdotactiondotassist": 0,
    "androiddotintentdotactiondotcall": 0,
    "androiddotintentdotactiondotcall_button": 0,
    "androiddotintentdotactiondotwallpaper_changed": 0,
    "androiddotintentdotactiondotquickboot_poweroff": 0,
    "androiddotintentdotactiondotclose_system_alarm": 0,
    "androiddotintentdotactiondotinsert": 0,
    "androiddotintentdotactiondotmedia_bad_removal": 0,
    "androiddotintentdotactiondotsearch_long_press": 0,
    "androiddotintentdotactiondotdefault": 0,
    "androiddotintentdotactiondotmusic_player": 0,
    "androiddotintentdotactiondotums_connected": 0,
    "androiddotintentdotactiondotexternal_applications_available": 0,
    "androiddotintentdotactiondotmedia_shared": 0,
    "androiddotintentdotactiondotcall_privileged": 0,
    "androiddotintentdotactiondotrun": 0,
    "androiddotintentdotactiondotcamsnap": 0,
    "androiddotintentdotactiondotdevice_storage_low": 0,
    "androiddotintentdotactiondotmanage_network_usage": 0,
    "androiddotintentdotactiondotvideocap": 0,
    "androiddotintentdotactiondotcamera_button": 0,
    "androiddotintentdotactiondotpackage_fully_removed": 0,
    "androiddotintentdotactiondotproxy_change": 0,
    "androiddotintentdotactiondotplug_in_airing": 0,
    "androiddotintentdotactiondotset_alarm": 0,
    "androiddotintentdotactiondotmedia_scanner_started": 0,
    "class": None
}
input_data = [mobfs_input, chimera_intents_input,
              chimera_permissions_input, chimera_merged_input]
model_names = ['mobfs', 'chimera_intents',
               'chimera_permissions', 'chimera_merged']
host = "localhost"
rest_api_port = 8501
predictions = []


def serve_model(model_name: str, payload: dict) -> dict:
    '''
    Serve the given model with the given payload.

    Args:
        model_name (str): Name of the model to serve.
        payload (dict): Payload to serve the model with.

    Returns:
        dict: Response from the model.
    '''
    logger.info(
        f"{bcolors.HEADER}[+] Serving model: {model_name}{bcolors.ENDC}")
    payload = {"inputs": {k: [v] for k, v in payload.items()}}
    url = f"http://{host}:{rest_api_port}/v1/models/{model_name}:predict"
    response = requests.post(url=url,
                             json=payload)
    logger.info(
        f"{bcolors.OKGREEN}[+] Model served: {model_name}{bcolors.ENDC}")
    return json.loads(response.text)['outputs']


def print_class(preds: list, datasets: list) -> None:
    '''
    Print the class of the given predictions.

    Args:
        preds (list): List of predictions.
        datasets (list): List of dataset names.
    '''
    print("| Dataset                               | Confidence Score | Confidence Percentage |")
    print("| --------------------------------------| -----------------| ----------------------|")
    total_score = 0
    for i, pred in enumerate(preds):

        score = pred[0][0]
        total_score += score
        dataset_name = datasets[i]
        benign_confidence = (1 - score) * 100
        malware_confidence = score * 100

        if score > 0.5:
            print(
                f"| {dataset_name} \t\t\t| {score:.2f} \t\t| Malware Confidence @ {malware_confidence:.2f}% |")
        else:
            print(
                f"| {dataset_name} \t\t\t| {score:.2f} \t\t| Benign Confidence @ {benign_confidence:.2f}% |")

    avg_score = total_score / len(preds)
    avg_benign_confidence = (1 - avg_score) * 100
    avg_malware_confidence = avg_score * 100

    if avg_score > 0.5:
        print(
            f"\nFinal Class: Malware Confidence @ {avg_malware_confidence:.2f}% (Score: {avg_score:.2f})")
    else:
        print(
            f"\nFinal Class: Benign Confidence @ {avg_benign_confidence:.2f}% (Score: {avg_score:.2f})")


for model_name, payload in zip(model_names, input_data):
    predictions.append(serve_model(model_name, payload))
output_names = ['mobfs', 'chimera_intents',
                'chimera_permissions', 'chimera_merged']
print_class(predictions, output_names)
# OUTPUT: should be malware
print("\n\n\n")
print("OUTPUT: should be malware")
