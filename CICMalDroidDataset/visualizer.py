import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

def generate_plots(csv_file: str):
    # Load the dataset
    data = pd.read_csv(csv_file)

    # Plot the distribution of classes
    plt.figure(figsize=(6, 4))
    sns.countplot(x="class", data=data)
    plt.title("Class Distribution")
    plt.xlabel("Class")
    plt.ylabel("Count")
    plt.xticks([0, 1], ["Benign", "Malware"])
    plt.show()

    # Plot the correlation heatmap
    plt.figure(figsize=(14, 10))
    sns.heatmap(data.corr(), annot=True, fmt=".2f", cmap="coolwarm")
    plt.title("API Feature Correlations")
    plt.show()

    # Plot histograms of API feature counts for malware and benign samples
    api_features = data.columns[:-1]

    fig, axes = plt.subplots(3, 6, figsize=(20, 10), constrained_layout=True)
    axes = axes.flatten()

    for i, feature in enumerate(api_features):
        sns.histplot(
            data=data,
            x=feature,
            hue="class",
            binwidth=1,
            discrete=True,
            ax=axes[i],
            palette="viridis",
        )
        axes[i].set_title(f"{feature} Distribution")
        axes[i].set_xlabel("Count")
        axes[i].set_ylabel("Frequency")

    plt.show()

if __name__ == "__main__":
    csv_file = "CICMalDroidDataset\CICMalDroidxMobFSDataset.csv"
    generate_plots(csv_file)