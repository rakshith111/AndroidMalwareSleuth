import json
import os
import csv

def compare_getCount():
    input_file = input("Enter the path of the input JSON file: ")
    output_path = input("Enter the output path: ")
    api_header_file = input("Enter the path of the API header CSV file: ")

    with open(input_file, 'r') as f:
        data = json.load(f)

    with open(api_header_file, 'r') as f:
        reader = csv.reader(f)
        api_header = {row[0] for row in reader}

    # def compare_getCount(input_file, output_path, api_header_file):
    # with open(input_file, 'r') as f:
    #     data = json.load(f)

    # with open(api_header_file, 'r') as f:
    #     reader = csv.reader(f)
    #     api_header = {row[0] for row in reader}

    filtered_data = {}
    for key, value in data.items():
        if key in api_header:
            filtered_data[key] = value

    for api_name, api_info in filtered_data.items():
        files = api_info.get("files", {})
        api_count = 0
        for file_path, line_numbers in files.items():
            lines = line_numbers.split(',')
            count = len(lines)
            api_count += count
            files[file_path] = str(count)
        filtered_data[api_name] = {'count': api_count}

    output_file = os.path.join(output_path, os.path.basename(input_file))

    with open(output_file, 'w') as f:
        json.dump(filtered_data, f, indent=4)

if __name__ == '__main__':
    main()
